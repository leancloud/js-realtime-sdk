{"version":3,"file":"webrtc.min.js","sources":["../../../node_modules/@babel/runtime/helpers/arrayWithHoles.js","../../../node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","../../../node_modules/@babel/runtime/helpers/arrayLikeToArray.js","../../../node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","../../../node_modules/@babel/runtime/helpers/nonIterableRest.js","../../../node_modules/@babel/runtime/helpers/slicedToArray.js","../../../node_modules/@babel/runtime/helpers/defineProperty.js","../../../node_modules/@babel/runtime/helpers/inheritsLoose.js","../../../node_modules/eventemitter3/index.js","../../../node_modules/@babel/runtime/helpers/createClass.js","../../../node_modules/javascript-state-machine/state-machine.js","../../../node_modules/inherit/lib/inherit.js","../src/realtime.js","../src/signalings/signaling.js","../src/signalings/answer.js","../src/signalings/ice-candidate.js","../src/signalings/refusal.js","../src/signalings/cancelation.js","../src/call/call.js","../src/call/call-state-machine.js","../src/call/outgoing-call.js","../src/call/incoming-call.js","../src/signalings/offer.js","../src/webrtc-client.js","../src/index.js"],"sourcesContent":["function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;","function _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;","function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray;","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableRest;","var arrayWithHoles = require(\"./arrayWithHoles\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableRest = require(\"./nonIterableRest\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n\nmodule.exports = _inheritsLoose;","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","/*\n\n  Javascript State Machine Library - https://github.com/jakesgordon/javascript-state-machine\n\n  Copyright (c) 2012, 2013, 2014, 2015, Jake Gordon and contributors\n  Released under the MIT license - https://github.com/jakesgordon/javascript-state-machine/blob/master/LICENSE\n\n*/\n\n(function () {\n\n  var StateMachine = {\n\n    //---------------------------------------------------------------------------\n\n    VERSION: \"2.4.0\",\n\n    //---------------------------------------------------------------------------\n\n    Result: {\n      SUCCEEDED:    1, // the event transitioned successfully from one state to another\n      NOTRANSITION: 2, // the event was successfull but no state transition was necessary\n      CANCELLED:    3, // the event was cancelled by the caller in a beforeEvent callback\n      PENDING:      4  // the event is asynchronous and the caller is in control of when the transition occurs\n    },\n\n    Error: {\n      INVALID_TRANSITION: 100, // caller tried to fire an event that was innapropriate in the current state\n      PENDING_TRANSITION: 200, // caller tried to fire an event while an async transition was still pending\n      INVALID_CALLBACK:   300 // caller provided callback function threw an exception\n    },\n\n    WILDCARD: '*',\n    ASYNC: 'async',\n\n    //---------------------------------------------------------------------------\n\n    create: function(cfg, target) {\n\n      var initial      = (typeof cfg.initial == 'string') ? { state: cfg.initial } : cfg.initial; // allow for a simple string, or an object with { state: 'foo', event: 'setup', defer: true|false }\n      var terminal     = cfg.terminal || cfg['final'];\n      var fsm          = target || cfg.target  || {};\n      var events       = cfg.events || [];\n      var callbacks    = cfg.callbacks || {};\n      var map          = {}; // track state transitions allowed for an event { event: { from: [ to ] } }\n      var transitions  = {}; // track events allowed from a state            { state: [ event ] }\n\n      var add = function(e) {\n        var from = Array.isArray(e.from) ? e.from : (e.from ? [e.from] : [StateMachine.WILDCARD]); // allow 'wildcard' transition if 'from' is not specified\n        map[e.name] = map[e.name] || {};\n        for (var n = 0 ; n < from.length ; n++) {\n          transitions[from[n]] = transitions[from[n]] || [];\n          transitions[from[n]].push(e.name);\n\n          map[e.name][from[n]] = e.to || from[n]; // allow no-op transition if 'to' is not specified\n        }\n        if (e.to)\n          transitions[e.to] = transitions[e.to] || [];\n      };\n\n      if (initial) {\n        initial.event = initial.event || 'startup';\n        add({ name: initial.event, from: 'none', to: initial.state });\n      }\n\n      for(var n = 0 ; n < events.length ; n++)\n        add(events[n]);\n\n      for(var name in map) {\n        if (map.hasOwnProperty(name))\n          fsm[name] = StateMachine.buildEvent(name, map[name]);\n      }\n\n      for(var name in callbacks) {\n        if (callbacks.hasOwnProperty(name))\n          fsm[name] = callbacks[name]\n      }\n\n      fsm.current     = 'none';\n      fsm.is          = function(state) { return Array.isArray(state) ? (state.indexOf(this.current) >= 0) : (this.current === state); };\n      fsm.can         = function(event) { return !this.transition && (map[event] !== undefined) && (map[event].hasOwnProperty(this.current) || map[event].hasOwnProperty(StateMachine.WILDCARD)); }\n      fsm.cannot      = function(event) { return !this.can(event); };\n      fsm.transitions = function()      { return (transitions[this.current] || []).concat(transitions[StateMachine.WILDCARD] || []); };\n      fsm.isFinished  = function()      { return this.is(terminal); };\n      fsm.error       = cfg.error || function(name, from, to, args, error, msg, e) { throw e || msg; }; // default behavior when something unexpected happens is to throw an exception, but caller can override this behavior if desired (see github issue #3 and #17)\n      fsm.states      = function() { return Object.keys(transitions).sort() };\n\n      if (initial && !initial.defer)\n        fsm[initial.event]();\n\n      return fsm;\n\n    },\n\n    //===========================================================================\n\n    doCallback: function(fsm, func, name, from, to, args) {\n      if (func) {\n        try {\n          return func.apply(fsm, [name, from, to].concat(args));\n        }\n        catch(e) {\n          return fsm.error(name, from, to, args, StateMachine.Error.INVALID_CALLBACK, \"an exception occurred in a caller-provided callback function\", e);\n        }\n      }\n    },\n\n    beforeAnyEvent:  function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onbeforeevent'],                       name, from, to, args); },\n    afterAnyEvent:   function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onafterevent'] || fsm['onevent'],      name, from, to, args); },\n    leaveAnyState:   function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onleavestate'],                        name, from, to, args); },\n    enterAnyState:   function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onenterstate'] || fsm['onstate'],      name, from, to, args); },\n    changeState:     function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onchangestate'],                       name, from, to, args); },\n\n    beforeThisEvent: function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onbefore' + name],                     name, from, to, args); },\n    afterThisEvent:  function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onafter'  + name] || fsm['on' + name], name, from, to, args); },\n    leaveThisState:  function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onleave'  + from],                     name, from, to, args); },\n    enterThisState:  function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onenter'  + to]   || fsm['on' + to],   name, from, to, args); },\n\n    beforeEvent: function(fsm, name, from, to, args) {\n      if ((false === StateMachine.beforeThisEvent(fsm, name, from, to, args)) ||\n          (false === StateMachine.beforeAnyEvent( fsm, name, from, to, args)))\n        return false;\n    },\n\n    afterEvent: function(fsm, name, from, to, args) {\n      StateMachine.afterThisEvent(fsm, name, from, to, args);\n      StateMachine.afterAnyEvent( fsm, name, from, to, args);\n    },\n\n    leaveState: function(fsm, name, from, to, args) {\n      var specific = StateMachine.leaveThisState(fsm, name, from, to, args),\n          general  = StateMachine.leaveAnyState( fsm, name, from, to, args);\n      if ((false === specific) || (false === general))\n        return false;\n      else if ((StateMachine.ASYNC === specific) || (StateMachine.ASYNC === general))\n        return StateMachine.ASYNC;\n    },\n\n    enterState: function(fsm, name, from, to, args) {\n      StateMachine.enterThisState(fsm, name, from, to, args);\n      StateMachine.enterAnyState( fsm, name, from, to, args);\n    },\n\n    //===========================================================================\n\n    buildEvent: function(name, map) {\n      return function() {\n\n        var from  = this.current;\n        var to    = map[from] || (map[StateMachine.WILDCARD] != StateMachine.WILDCARD ? map[StateMachine.WILDCARD] : from) || from;\n        var args  = Array.prototype.slice.call(arguments); // turn arguments into pure array\n\n        if (this.transition)\n          return this.error(name, from, to, args, StateMachine.Error.PENDING_TRANSITION, \"event \" + name + \" inappropriate because previous transition did not complete\");\n\n        if (this.cannot(name))\n          return this.error(name, from, to, args, StateMachine.Error.INVALID_TRANSITION, \"event \" + name + \" inappropriate in current state \" + this.current);\n\n        if (false === StateMachine.beforeEvent(this, name, from, to, args))\n          return StateMachine.Result.CANCELLED;\n\n        if (from === to) {\n          StateMachine.afterEvent(this, name, from, to, args);\n          return StateMachine.Result.NOTRANSITION;\n        }\n\n        // prepare a transition method for use EITHER lower down, or by caller if they want an async transition (indicated by an ASYNC return value from leaveState)\n        var fsm = this;\n        this.transition = function() {\n          fsm.transition = null; // this method should only ever be called once\n          fsm.current = to;\n          StateMachine.enterState( fsm, name, from, to, args);\n          StateMachine.changeState(fsm, name, from, to, args);\n          StateMachine.afterEvent( fsm, name, from, to, args);\n          return StateMachine.Result.SUCCEEDED;\n        };\n        this.transition.cancel = function() { // provide a way for caller to cancel async transition if desired (issue #22)\n          fsm.transition = null;\n          StateMachine.afterEvent(fsm, name, from, to, args);\n        }\n\n        var leave = StateMachine.leaveState(this, name, from, to, args);\n        if (false === leave) {\n          this.transition = null;\n          return StateMachine.Result.CANCELLED;\n        }\n        else if (StateMachine.ASYNC === leave) {\n          return StateMachine.Result.PENDING;\n        }\n        else {\n          if (this.transition) // need to check in case user manually called transition() but forgot to return StateMachine.ASYNC\n            return this.transition();\n        }\n\n      };\n    }\n\n  }; // StateMachine\n\n  //===========================================================================\n\n  //======\n  // NODE\n  //======\n  if (typeof exports !== 'undefined') {\n    if (typeof module !== 'undefined' && module.exports) {\n      exports = module.exports = StateMachine;\n    }\n    exports.StateMachine = StateMachine;\n  }\n  //============\n  // AMD/REQUIRE\n  //============\n  else if (typeof define === 'function' && define.amd) {\n    define(function(require) { return StateMachine; });\n  }\n  //========\n  // BROWSER\n  //========\n  else if (typeof window !== 'undefined') {\n    window.StateMachine = StateMachine;\n  }\n  //===========\n  // WEB WORKER\n  //===========\n  else if (typeof self !== 'undefined') {\n    self.StateMachine = StateMachine;\n  }\n\n}());\n","/**\n * @module inherit\n * @version 2.2.7\n * @author Filatov Dmitry <dfilatov@yandex-team.ru>\n * @description This module provides some syntax sugar for \"class\" declarations, constructors, mixins, \"super\" calls and static members.\n */\n\n(function(global) {\n\nvar noop = function() {},\n    hasOwnProperty = Object.prototype.hasOwnProperty,\n    objCreate = Object.create || function(ptp) {\n        var inheritance = function() {};\n        inheritance.prototype = ptp;\n        return new inheritance();\n    },\n    objKeys = Object.keys || function(obj) {\n        var res = [];\n        for(var i in obj) {\n            hasOwnProperty.call(obj, i) && res.push(i);\n        }\n        return res;\n    },\n    extend = function(o1, o2) {\n        for(var i in o2) {\n            hasOwnProperty.call(o2, i) && (o1[i] = o2[i]);\n        }\n\n        return o1;\n    },\n    extendStatic = Object.setPrototypeOf || extend,\n    toStr = Object.prototype.toString,\n    isArray = Array.isArray || function(obj) {\n        return toStr.call(obj) === '[object Array]';\n    },\n    isFunction = function(obj) {\n        return toStr.call(obj) === '[object Function]';\n    },\n    needCheckProps = true,\n    testPropObj = { toString : '' };\n\nfor(var i in testPropObj) { // It's a pity ie hasn't toString, valueOf in for\n    testPropObj.hasOwnProperty(i) && (needCheckProps = false);\n}\n\nvar specProps = needCheckProps? ['toString', 'valueOf'] : null;\n\nfunction getPropList(obj) {\n    var res = objKeys(obj);\n    if(needCheckProps) {\n        var specProp, i = 0;\n        while(specProp = specProps[i++]) {\n            obj.hasOwnProperty(specProp) && res.push(specProp);\n        }\n    }\n\n    return res;\n}\n\nfunction override(base, res, add) {\n    var addList = getPropList(add),\n        j = 0, len = addList.length,\n        name, prop;\n    while(j < len) {\n        if((name = addList[j++]) === '__self') {\n            continue;\n        }\n        prop = add[name];\n        if(isFunction(prop) &&\n                (!prop.prototype || !prop.prototype.__self) && // check to prevent wrapping of \"class\" functions\n                (prop.toString().indexOf('.__base') > -1)) {\n            res[name] = (function(name, prop) {\n                var baseMethod = base[name]?\n                        base[name] :\n                        name === '__constructor'? // case of inheritance from plain function\n                            res.__self.__parent :\n                            noop,\n                    result = function() {\n                        var baseSaved = this.__base;\n\n                        this.__base = result.__base;\n                        var res = prop.apply(this, arguments);\n                        this.__base = baseSaved;\n\n                        return res;\n                    };\n                result.__base = baseMethod;\n\n                return result;\n            })(name, prop);\n        } else {\n            res[name] = prop;\n        }\n    }\n}\n\nfunction applyMixins(mixins, res) {\n    var i = 1, mixin;\n    while(mixin = mixins[i++]) {\n        res?\n            isFunction(mixin)?\n                inherit.self(res, mixin.prototype, mixin) :\n                inherit.self(res, mixin) :\n            res = isFunction(mixin)?\n                inherit(mixins[0], mixin.prototype, mixin) :\n                inherit(mixins[0], mixin);\n    }\n    return res || mixins[0];\n}\n\n/**\n* Creates class\n* @exports\n* @param {Function|Array} [baseClass|baseClassAndMixins] class (or class and mixins) to inherit from\n* @param {Object} prototypeFields\n* @param {Object} [staticFields]\n* @returns {Function} class\n*/\nfunction inherit() {\n    var args = arguments,\n        withMixins = isArray(args[0]),\n        hasBase = withMixins || isFunction(args[0]),\n        base = hasBase? withMixins? applyMixins(args[0]) : args[0] : noop,\n        props = args[hasBase? 1 : 0] || {},\n        staticProps = args[hasBase? 2 : 1],\n        res = props.__constructor || (hasBase && base.prototype && base.prototype.__constructor)?\n            function() {\n                return this.__constructor.apply(this, arguments);\n            } :\n            hasBase?\n                function() {\n                    return base.apply(this, arguments);\n                } :\n                function() {};\n\n    if(!hasBase) {\n        res.prototype = props;\n        res.prototype.__self = res.prototype.constructor = res;\n        return extend(res, staticProps);\n    }\n\n    extendStatic(res, base);\n\n    res.__parent = base;\n\n    var basePtp = base.prototype,\n        resPtp = res.prototype = objCreate(basePtp);\n\n    resPtp.__self = resPtp.constructor = res;\n\n    props && override(basePtp, resPtp, props);\n    staticProps && override(base, res, staticProps);\n\n    return res;\n}\n\ninherit.self = function() {\n    var args = arguments,\n        withMixins = isArray(args[0]),\n        base = withMixins? applyMixins(args[0], args[0][0]) : args[0],\n        props = args[1],\n        staticProps = args[2],\n        basePtp = base.prototype;\n\n    props && override(basePtp, basePtp, props);\n    staticProps && override(base, base, staticProps);\n\n    return base;\n};\n\nvar defineAsGlobal = true;\n/* istanbul ignore next */\nif(typeof exports === 'object') {\n    module.exports = inherit;\n    defineAsGlobal = false;\n}\n/* istanbul ignore next */\nif(typeof modules === 'object' && typeof modules.define === 'function') {\n    modules.define('inherit', function(provide) {\n        provide(inherit);\n    });\n    defineAsGlobal = false;\n}\n/* istanbul ignore next */\nif(typeof define === 'function') {\n    define(function(require, exports, module) {\n        module.exports = inherit;\n    });\n    defineAsGlobal = false;\n}\n/* istanbul ignore next */\ndefineAsGlobal && (global.inherit = inherit);\n\n})(this);\n","/* eslint-disable import/no-unresolved */\nimport { TypedMessage } from 'leancloud-realtime';\n\nif (!TypedMessage) {\n  throw new Error('LeanCloud Realtime SDK not installed');\n}\n\nexport { TypedMessage, messageType, messageField } from 'leancloud-realtime';\n","import inherit from 'inherit';\nimport { TypedMessage, messageField } from '../realtime';\n\n// use dynamic class inherit helper instead of ES class syntex\n// to prevent TypedMessage from being included in the bundler\nconst Signaling = inherit(TypedMessage, {\n  __constructor(payload) {\n    this.__base();\n    this.payload = payload;\n  },\n});\nSignaling.sendOptions = {\n  transient: true,\n};\n\nmessageField('payload')(Signaling);\n\nexport { Signaling as default };\n","import Signaling from './signaling';\nimport { messageType } from '../realtime';\n\n@messageType(-102)\nexport default class Answer extends Signaling {}\n","import Signaling from './signaling';\nimport { messageType } from '../realtime';\n\n@messageType(-103)\nexport default class ICECandidate extends Signaling {}\n","import Signaling from './signaling';\nimport { messageType } from '../realtime';\n\n@messageType(-104)\nexport default class Refusal extends Signaling {}\n","import Signaling from './signaling';\nimport { messageType } from '../realtime';\n\n@messageType(-105)\nexport default class Cancelation extends Signaling {}\n","import EventEmitter from 'eventemitter3';\nimport createCallStateMachine from './call-state-machine';\nimport Answer from '../signalings/answer';\nimport ICECandidate from '../signalings/ice-candidate';\nimport Refusal from '../signalings/refusal';\nimport Cancelation from '../signalings/cancelation';\n\nexport default class Call extends EventEmitter {\n  /**\n   * {@link IncomingCall} 与 {@link OutgoingCall} 的基类\n   * @abstract\n   */\n  constructor(conversation, RTCConfiguration) {\n    super();\n    this._setConversation(conversation);\n    this._peerConnection = this._createPeerConnection(RTCConfiguration);\n    this._call = createCallStateMachine();\n    this._promises = {};\n    const streamReady = new Promise(resolve => {\n      this._promises.resolveStreamReady = resolve;\n    });\n    const accept = new Promise(resolve => {\n      this._promises.resolveAccept = resolve;\n    });\n    Promise.all([streamReady, accept]).then(([stream]) => {\n      if (this._call.can('connect')) {\n        this._call.connect();\n        /**\n         * 通话连接成功\n         * @event Call#connect\n         * @param {MediaStream} stram 对方的媒体流\n         */\n        this.emit('connect', stream);\n      }\n    });\n  }\n\n  /**\n   * 当前通话状态\n   * （<code>calling</code>, <code>connected</code>, <code>closed</code>,\n   * <code>refused</code>, <code>canceled</code>）\n   * @type {string}\n   * @readonly\n   */\n  get state() {\n    return this._call.current;\n  }\n\n  /**\n   * 结束通话\n   * @return {Promise}\n   */\n  close() {\n    return Promise.resolve().then(() => {\n      this._call.close();\n      this._destroyPeerConnection();\n      this._peerConnection.close();\n      this._destroy();\n    });\n  }\n\n  _handleCloseEvent() {\n    if (this._call.can('close')) {\n      this.close();\n      /**\n       * 通话结束，可能是对方挂断或网络中断\n       * @event Call#close\n       */\n      this.emit('close');\n    }\n  }\n\n  _setConversation(conversation) {\n    if (this._conversation) {\n      this._conversation.off('message');\n    }\n    if (conversation) {\n      this._conversation = conversation;\n      conversation.on('message', this._handleMessage.bind(this));\n    }\n  }\n\n  _destroy() {\n    this._conversation.off('message');\n  }\n\n  _createPeerConnection(RTCConfiguration) {\n    const connection = new RTCPeerConnection(RTCConfiguration);\n    connection.onicecandidate = this._handleICECandidateEvent.bind(this);\n    connection.onaddstream = this._handleAddStreamEvent.bind(this);\n    connection.onnremovestream = this._handleRemoveStreamEvent.bind(this);\n    connection.oniceconnectionstatechange = this._handleICEConnectionStateChangeEvent.bind(\n      this\n    );\n    connection.onsignalingstatechange = this._handleSignalingStateChangeEvent.bind(\n      this\n    );\n    return connection;\n  }\n\n  _destroyPeerConnection() {\n    const connection = this._peerConnection;\n    delete connection.onaddstream;\n    delete connection.onremovestream;\n    delete connection.onnicecandidate;\n    delete connection.oniceconnectionstatechange;\n    delete connection.onsignalingstatechange;\n  }\n\n  _handleMessage(message) {\n    if (message instanceof Answer) {\n      return this._handleAnswer(message);\n    }\n    if (message instanceof Refusal) {\n      return this._handleRefusal();\n    }\n    if (message instanceof Cancelation) {\n      return this._handleCancelation();\n    }\n    if (message instanceof ICECandidate) {\n      return this._handleICECandidate(message);\n    }\n    return false;\n  }\n\n  _handleICECandidate(message) {\n    const candidate = new RTCIceCandidate(message.payload);\n    if (this._peerConnection) {\n      this._peerConnection\n        .addIceCandidate(candidate)\n        .catch(console.error.bind(console));\n    }\n  }\n\n  _handleICECandidateEvent(event) {\n    if (event.candidate && this._conversation) {\n      return this._conversation\n        .send(new ICECandidate(event.candidate))\n        .catch(console.error.bind(console));\n    }\n    return false;\n  }\n\n  _handleAddStreamEvent(event) {\n    this._promises.resolveStreamReady(event.stream);\n  }\n\n  _handleRemoveStreamEvent() {\n    this._handleCloseEvent();\n  }\n\n  _handleICEConnectionStateChangeEvent() {\n    switch (this._peerConnection.iceConnectionState) {\n      case 'closed':\n      case 'failed':\n      case 'disconnected':\n        this._handleCloseEvent();\n        break;\n      default:\n    }\n  }\n\n  _handleSignalingStateChangeEvent() {\n    switch (this._peerConnection.signalingState) {\n      case 'closed':\n        this._handleCloseEvent();\n        break;\n      default:\n    }\n  }\n\n  /* eslint-disable class-methods-use-this */\n  _handleAnswer() {\n    throw new Error('not implemented');\n  }\n\n  _handleRefusal() {\n    throw new Error('not implemented');\n  }\n\n  _handleCancelation() {\n    throw new Error('not implemented');\n  }\n  /* eslint-enable class-methods-use-this */\n}\n","import StateMachine from 'javascript-state-machine';\n\nexport default () =>\n  StateMachine.create({\n    initial: 'calling',\n    events: [\n      {\n        name: 'connect',\n        from: 'calling',\n        to: 'connected',\n      },\n      {\n        name: 'close',\n        from: 'connected',\n        to: 'closed',\n      },\n      {\n        name: 'cancel',\n        from: 'calling',\n        to: 'canceled',\n      },\n      {\n        name: 'refuse',\n        from: 'calling',\n        to: 'refused',\n      },\n    ],\n  });\n","import Call from './call';\nimport Cancelation from '../signalings/cancelation';\n\nexport default class OutgoingCall extends Call {\n  /**\n   * 呼出的通话\n   * @extends Call\n   */\n  constructor(to, conversation, RTCConfiguration) {\n    super(conversation, RTCConfiguration);\n    /**\n     * 呼叫目标 id\n     * @type {string}\n     */\n    this.to = to;\n  }\n\n  _handleAnswer(answer) {\n    const desc = new RTCSessionDescription(answer.payload);\n    this._peerConnection.setRemoteDescription(desc);\n    this._promises.resolveAccept();\n  }\n\n  _handleRefusal() {\n    this._destroyPeerConnection();\n    this._call.refuse();\n    /**\n     * 呼叫被对方拒绝\n     * @event OutgoingCall#refuse\n     */\n    this.emit('refuse');\n    this._destroy();\n  }\n\n  /**\n   * 取消该次呼叫\n   * @return {Promise}\n   */\n  cancel() {\n    this._call.cancel();\n    return this._conversation\n      .send(new Cancelation())\n      .then(() => this._destroy());\n  }\n\n  /**\n   * 结束通话，如果在 <code>calling</code> 状态，则取消该次呼叫\n   * @return {Promise}\n   */\n  close() {\n    if (this._call.can('cancel')) {\n      return this.cancel();\n    }\n    return super.close();\n  }\n}\n","import Call from './call';\nimport Answer from '../signalings/answer';\nimport Refusal from '../signalings/refusal';\n\nexport default class IncomingCall extends Call {\n  /**\n   * 呼入的通话\n   * @extends Call\n   */\n  constructor(offer, conversation, RTCConfiguration) {\n    super(conversation, RTCConfiguration);\n    /**\n     * 呼叫者 id\n     * @type {string}\n     */\n    this.from = offer.from;\n    const desc = new RTCSessionDescription(offer.payload);\n    this._handleOfferPromise = this._peerConnection.setRemoteDescription(desc);\n  }\n\n  /**\n   * 接受该呼入通话\n   * @param  {MediaStream} stream 本地流媒体，参见 {@link https://developer.mozilla.org/en-US/docs/Web/API/Media_Streams_API MediaStream}\n   * @return {Promise}\n   */\n  accept(stream) {\n    if (!stream) {\n      throw new TypeError(\n        'a MediaStream instance is required to accept a call'\n      );\n    }\n    return this._handleOfferPromise\n      .then(() => this._peerConnection.addStream(stream))\n      .then(() => this._peerConnection.createAnswer())\n      .then(answer => this._peerConnection.setLocalDescription(answer))\n      .then(() =>\n        this._conversation.send(\n          new Answer(this._peerConnection.localDescription)\n        )\n      )\n      .then(() => this._promises.resolveAccept());\n  }\n\n  /**\n   * 拒绝该呼入通话\n   * @return {Promise}\n   */\n  refuse() {\n    return this._conversation.send(new Refusal()).then(() => {\n      this._call.refuse();\n      this._destroy();\n    });\n  }\n\n  _handleCancelation() {\n    this._call.cancel();\n    /**\n     * 呼叫被对方取消\n     * @event IncomingCall#cancel\n     */\n    this.emit('cancel');\n    this._destroy();\n  }\n}\n","import Signaling from './signaling';\nimport { messageType } from '../realtime';\n\n@messageType(-101)\nexport default class Offer extends Signaling {}\n","import EventEmitter from 'eventemitter3';\nimport OutgoingCall from './call/outgoing-call';\nimport IncomingCall from './call/incoming-call';\nimport Offer from './signalings/offer';\n\nconst DEFAULT_RTCCONF = {\n  iceServers: [\n    {\n      urls: [\n        'stun:stun.l.google.com:19302',\n        'stun:stun1.l.google.com:19302',\n        'stun:stun2.l.google.com:19302',\n        'stun:stun3.l.google.com:19302',\n        'stun:stun4.l.google.com:19302',\n        'stun:stun.ekiga.net',\n        'stun:stun.ideasip.com',\n        'stun:stun.rixtelecom.se',\n        'stun:stun.schlund.de',\n        'stun:stun.stunprotocol.org:3478',\n        'stun:stun.voiparound.com',\n        'stun:stun.voipbuster.com',\n        'stun:stun.voipstunt.com',\n        'stun:stun.voxgratia.org',\n      ],\n    },\n  ],\n};\n\nexport default class WebRTCClient extends EventEmitter {\n  /**\n   * 无法直接实例化，请使用 {@link createWebRTCClient Realtime#createWebRTCClient} 创建新的 WebRTCClient\n   */\n  constructor(id, options) {\n    if (typeof id !== 'string') {\n      throw new TypeError('id is not a string');\n    }\n    super();\n    /** @type {string} */\n    this.id = id;\n    this.options = {\n      RTCConfiguration: DEFAULT_RTCCONF,\n      ...options,\n    };\n  }\n\n  _open(realtime, clientOptions) {\n    return realtime\n      .createIMClient(this.id, clientOptions, 'webrtc')\n      .then(imClient => {\n        this._imClient = imClient;\n        this.id = imClient.id;\n        imClient.on('message', (message, conversation) => {\n          if (message instanceof Offer) {\n            return this._handleOffer(message, conversation);\n          }\n          return false;\n        });\n        /**\n         * 用户在其他客户端登录，当前客户端被服务端强行下线。详见文档「单点登录」章节。\n         * @event WebRTCClient#conflict\n         */\n        imClient.on('conflict', (...payload) =>\n          this.emit('conflict', ...payload)\n        );\n        return this;\n      });\n  }\n\n  /**\n   * 关闭客户端\n   * @return {Promise}\n   */\n  close() {\n    return this._imClient.close();\n  }\n\n  /**\n   * 呼叫另一个用户\n   * @param  {string} targetId 用户 ID\n   * @param  {MediaStream} stream 本地流媒体，参见 {@link https://developer.mozilla.org/en-US/docs/Web/API/Media_Streams_API MediaStream}\n   * @return {Promise.<OutgoingCall>} 呼出通话\n   */\n  call(targetId, stream) {\n    if (typeof targetId !== 'string') {\n      throw new TypeError('target id is not a string');\n    }\n    if (!stream) {\n      throw new TypeError('a MediaStream instance is required to make a call');\n    }\n    return this._imClient.ping([targetId]).then(onlineClients => {\n      if (!onlineClients.length) {\n        throw new Error(`Call failed as ${targetId} is not online`);\n      }\n      const outgoingCall = new OutgoingCall(\n        targetId,\n        null,\n        this.options.RTCConfiguration\n      );\n      const promise = new Promise(resolve => {\n        outgoingCall._peerConnection.onnegotiationneeded = resolve;\n      });\n      outgoingCall._peerConnection.addStream(stream);\n      return promise\n        .then(() =>\n          Promise.all([\n            this._imClient.createConversation({\n              members: [targetId],\n              unique: true,\n            }),\n            outgoingCall._peerConnection\n              .createOffer()\n              .then(localDescription => {\n                outgoingCall._peerConnection.setLocalDescription(\n                  localDescription\n                );\n              }),\n          ])\n        )\n        .then(([conversation]) => {\n          outgoingCall._setConversation(conversation);\n          return conversation.send(\n            new Offer(outgoingCall._peerConnection.localDescription)\n          );\n        })\n        .then(() => outgoingCall);\n    });\n  }\n\n  _handleOffer(offer, conversation) {\n    const incomingCall = new IncomingCall(\n      offer,\n      conversation,\n      this.options.RTCConfiguration\n    );\n    /**\n     * 收到其他用户的呼叫\n     * @event WebRTCClient#call\n     * @param {incomingCall} incomingCall 呼入通话\n     */\n    this.emit('call', incomingCall);\n  }\n}\n","/* eslint-disable import/prefer-default-export */\n/** @module leancloud-realtime-plugin-webrtc */\nimport WebRTCClient from './webrtc-client';\nimport Offer from './signalings/offer';\nimport Answer from './signalings/answer';\nimport ICECandidate from './signalings/ice-candidate';\nimport Refusal from './signalings/refusal';\nimport Cancelation from './signalings/cancelation';\nimport { name } from '../package.json';\n\nconst messageClasses = [Offer, Answer, ICECandidate, Refusal, Cancelation];\n\nconst onRealtimeCreate = realtime => {\n  /**\n   * 创建一个 WebRTC 客户端，多次创建相同 id 的客户端会返回同一个实例。应用 WebRTC 插件后，Realtime 类会增加该实例方法。\n   * WebRTC 客户端是单点登录的，既在同一时刻，同一个 id 只允许一个客户端在线，后登录的客户端会将原来在线上的客户端踢下线。\n   * @function createWebRTCClient\n   * @global\n   * @param  {String} id 客户端 id\n   * @param  {Object} [clientOptions] 详细参数 @see {@link IMClient}\n   * @param  {Object} [clientOptions.RTCConfiguration] @see {@link https://developer.mozilla.org/en-US/docs/Web/API/RTCConfiguration RTCConfiguration}\n   * @return {Promise.<WebRTCClient>}\n   */\n  // eslint-disable-next-line no-param-reassign\n  realtime.createWebRTCClient = (id, clientOptions) =>\n    new WebRTCClient(id)._open(realtime, clientOptions);\n};\n\n/**\n * WebRTC 插件，使用后可通过 {@link createWebRTCClient Realtime#createWebRTCClient}\n * 创建 {@link WebRTCClient} 实现音视频通话\n * @example\n * var realtime = new Realtime({\n *   appId: appId,\n *   appKey: appKey,\n *   server: server,\n *   plugins: WebRTCPlugin,\n * });\n * realtime.createWebRTCClient(id);\n */\nexport const WebRTCPlugin = {\n  name,\n  messageClasses,\n  onRealtimeCreate,\n};\n\n/**\n * 当前浏览器是否支持 WebRTC 的标记\n * @type {Boolean}\n */\nexport const isWebRTCSupported = !!(\n  window.RTCPeerConnection &&\n  window.RTCSessionDescription &&\n  window.RTCIceCandidate\n);\n"],"names":["arr","Array","isArray","i","Symbol","iterator","Object","_arr","_n","_d","_e","undefined","_s","_i","next","done","push","value","length","err","len","arr2","o","minLen","arrayLikeToArray","n","prototype","toString","call","slice","constructor","name","from","test","TypeError","arrayWithHoles","iterableToArrayLimit","unsupportedIterableToArray","nonIterableRest","obj","key","defineProperty","enumerable","configurable","writable","subClass","superClass","create","__proto__","has","hasOwnProperty","prefix","Events","EE","fn","context","once","this","addListener","emitter","event","listener","evt","_events","_eventsCount","clearEvent","EventEmitter","eventNames","events","names","getOwnPropertySymbols","concat","listeners","handlers","l","ee","listenerCount","emit","a1","a2","a3","a4","a5","args","arguments","removeListener","apply","j","on","removeAllListeners","off","prefixed","module","_defineProperties","target","props","descriptor","Constructor","protoProps","staticProps","StateMachine","VERSION","Result","SUCCEEDED","NOTRANSITION","CANCELLED","PENDING","Error","INVALID_TRANSITION","PENDING_TRANSITION","INVALID_CALLBACK","WILDCARD","ASYNC","cfg","initial","state","terminal","fsm","callbacks","map","transitions","add","e","to","buildEvent","current","is","indexOf","can","transition","cannot","isFinished","error","msg","states","keys","sort","defer","doCallback","func","beforeAnyEvent","afterAnyEvent","leaveAnyState","enterAnyState","changeState","beforeThisEvent","afterThisEvent","leaveThisState","enterThisState","beforeEvent","afterEvent","leaveState","specific","general","enterState","cancel","leave","exports","global","noop","objCreate","ptp","inheritance","objKeys","res","extend","o1","o2","extendStatic","setPrototypeOf","toStr","isFunction","needCheckProps","testPropObj","specProps","override","base","prop","addList","specProp","getPropList","__self","baseMethod","__parent","result","baseSaved","__base","applyMixins","mixins","mixin","inherit","self","withMixins","hasBase","__constructor","basePtp","resPtp","defineAsGlobal","modules","define","provide","TypedMessage","Signaling","payload","sendOptions","Answer","messageType","ICECandidate","Refusal","Cancelation","Call","conversation","RTCConfiguration","_setConversation","_peerConnection","_this","_createPeerConnection","_call","_promises","streamReady","Promise","resolve","resolveStreamReady","accept","resolveAccept","all","then","stream","connect","close","_this2","_destroyPeerConnection","_destroy","_handleCloseEvent","_conversation","_handleMessage","bind","connection","RTCPeerConnection","onicecandidate","_handleICECandidateEvent","onaddstream","_handleAddStreamEvent","onnremovestream","_handleRemoveStreamEvent","oniceconnectionstatechange","_handleICEConnectionStateChangeEvent","onsignalingstatechange","_handleSignalingStateChangeEvent","onremovestream","onnicecandidate","message","_handleAnswer","_handleRefusal","_handleCancelation","_handleICECandidate","candidate","RTCIceCandidate","addIceCandidate","console","send","iceConnectionState","signalingState","OutgoingCall","answer","desc","RTCSessionDescription","setRemoteDescription","refuse","IncomingCall","offer","_handleOfferPromise","addStream","createAnswer","setLocalDescription","localDescription","_this3","Offer","DEFAULT_RTCCONF","iceServers","urls","WebRTCClient","id","options","_open","realtime","clientOptions","createIMClient","imClient","_imClient","_handleOffer","targetId","ping","onlineClients","outgoingCall","promise","onnegotiationneeded","createConversation","members","unique","createOffer","incomingCall","WebRTCPlugin","messageClasses","onRealtimeCreate","createWebRTCClient","isWebRTCSupported","window"],"mappings":"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"}