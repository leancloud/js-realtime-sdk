!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports,require("leancloud-storage"),require("leancloud-realtime")):"function"==typeof define&&define.amd?define("typed-messages",["exports","leancloud-storage","leancloud-realtime"],b):b(a.AV=a.AV||{},a.AV,a.AV)}(this,function(a,b,c){"use strict";function d(a,b){return b={exports:{}},a(b,b.exports),b.exports}var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},f=d(function(a){var b=a.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=b)}),g=d(function(a){var b=a.exports={version:"2.4.0"};"number"==typeof __e&&(__e=b)}),h=function(a){if("function"!=typeof a)throw TypeError(a+" is not a function!");return a},i=h,j=function(a,b,c){if(i(a),void 0===b)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)}}return function(){return a.apply(b,arguments)}},k=function(a){return"object"==typeof a?null!==a:"function"==typeof a},l=k,m=function(a){if(!l(a))throw TypeError(a+" is not an object!");return a},n=function(a){try{return!!a()}catch(a){return!0}},o=!n(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),p=k,q=f.document,r=p(q)&&p(q.createElement),s=function(a){return r?q.createElement(a):{}},t=!o&&!n(function(){return 7!=Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}),u=k,v=function(a,b){if(!u(a))return a;var c,d;if(b&&"function"==typeof(c=a.toString)&&!u(d=c.call(a)))return d;if("function"==typeof(c=a.valueOf)&&!u(d=c.call(a)))return d;if(!b&&"function"==typeof(c=a.toString)&&!u(d=c.call(a)))return d;throw TypeError("Can't convert object to primitive value")},w=m,x=t,y=v,z=Object.defineProperty,A=o?Object.defineProperty:function(a,b,c){if(w(a),b=y(b,!0),w(c),x)try{return z(a,b,c)}catch(a){}if("get"in c||"set"in c)throw TypeError("Accessors not supported!");return"value"in c&&(a[b]=c.value),a},B={f:A},C=function(a,b){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:b}},D=B,E=C,F=o?function(a,b,c){return D.f(a,b,E(1,c))}:function(a,b,c){return a[b]=c,a},G=f,H=g,I=j,J=F,K=function(a,b,c){var d,e,f,g=a&K.F,h=a&K.G,i=a&K.S,j=a&K.P,k=a&K.B,l=a&K.W,m=h?H:H[b]||(H[b]={}),n=m.prototype,o=h?G:i?G[b]:(G[b]||{}).prototype;h&&(c=b);for(d in c)(e=!g&&o&&void 0!==o[d])&&d in m||(f=e?o[d]:c[d],m[d]=h&&"function"!=typeof o[d]?c[d]:k&&e?I(f,G):l&&o[d]==f?function(a){var b=function(b,c,d){if(this instanceof a){switch(arguments.length){case 0:return new a;case 1:return new a(b);case 2:return new a(b,c)}return new a(b,c,d)}return a.apply(this,arguments)};return b.prototype=a.prototype,b}(f):j&&"function"==typeof f?I(Function.call,f):f,j&&((m.virtual||(m.virtual={}))[d]=f,a&K.R&&n&&!n[d]&&J(n,d,f)))};K.F=1,K.G=2,K.S=4,K.P=8,K.B=16,K.W=32,K.U=64,K.R=128;var L=K,M={}.hasOwnProperty,N=function(a,b){return M.call(a,b)},O={}.toString,P=function(a){return O.call(a).slice(8,-1)},Q=P,R=Object("z").propertyIsEnumerable(0)?Object:function(a){return"String"==Q(a)?a.split(""):Object(a)},S=function(a){if(void 0==a)throw TypeError("Can't call method on  "+a);return a},T=R,U=S,V=function(a){return T(U(a))},W=Math.ceil,X=Math.floor,Y=function(a){return isNaN(a=+a)?0:(a>0?X:W)(a)},Z=Y,$=Math.min,_=function(a){return a>0?$(Z(a),9007199254740991):0},aa=Y,ba=Math.max,ca=Math.min,da=function(a,b){return a=aa(a),a<0?ba(a+b,0):ca(a,b)},ea=V,fa=_,ga=da,ha=f,ia=ha["__core-js_shared__"]||(ha["__core-js_shared__"]={}),ja=0,ka=Math.random(),la=function(a){return"Symbol(".concat(void 0===a?"":a,")_",(++ja+ka).toString(36))},ma=function(a){return ia[a]||(ia[a]={})}("keys"),na=la,oa=N,pa=V,qa=function(a){return function(b,c,d){var e,f=ea(b),g=fa(f.length),h=ga(d,g);if(a&&c!=c){for(;g>h;)if((e=f[h++])!=e)return!0}else for(;g>h;h++)if((a||h in f)&&f[h]===c)return a||h||0;return!a&&-1}}(!1),ra=function(a){return ma[a]||(ma[a]=na(a))}("IE_PROTO"),sa=function(a,b){var c,d=pa(a),e=0,f=[];for(c in d)c!=ra&&oa(d,c)&&f.push(c);for(;b.length>e;)oa(d,c=b[e++])&&(~qa(f,c)||f.push(c));return f},ta="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),ua=sa,va=ta,wa=Object.keys||function(a){return ua(a,va)},xa=Object.getOwnPropertySymbols,ya={f:xa},za={}.propertyIsEnumerable,Aa={f:za},Ba=S,Ca=function(a){return Object(Ba(a))},Da=wa,Ea=ya,Fa=Aa,Ga=Ca,Ha=R,Ia=Object.assign,Ja=!Ia||n(function(){var a={},b={},c=Symbol(),d="abcdefghijklmnopqrst";return a[c]=7,d.split("").forEach(function(a){b[a]=a}),7!=Ia({},a)[c]||Object.keys(Ia({},b)).join("")!=d})?function(a,b){for(var c=Ga(a),d=arguments.length,e=1,f=Ea.f,g=Fa.f;d>e;)for(var h,i=Ha(arguments[e++]),j=f?Da(i).concat(f(i)):Da(i),k=j.length,l=0;k>l;)g.call(i,h=j[l++])&&(c[h]=i[h]);return c}:Ia,Ka=L;Ka(Ka.S+Ka.F,"Object",{assign:Ja});var La=g.Object.assign,Ma=d(function(a){a.exports={default:La,__esModule:!0}}),Na=function(a){return a&&a.__esModule?a.default:a}(Ma),Oa=d(function(a,b){!function(b){function c(a){var b=k(a);if(q)for(var c,d=0;c=t[d++];)a.hasOwnProperty(c)&&b.push(c);return b}function d(a,b,d){for(var e,f,h=c(d),i=0,j=h.length;i<j;)"__self"!==(e=h[i++])&&(f=d[e],!o(f)||f.prototype&&f.prototype.__self||g&&!(f.toString().indexOf(".__base")>-1)?b[e]=f:b[e]=function(c,d){var e=a[c]?a[c]:"__constructor"===c?b.__self.__parent:p,f=function(){var a=this.__base;this.__base=f.__base;var b=d.apply(this,arguments);return this.__base=a,b};return f.__base=e,f}(e,f))}function e(a,b){for(var c,d=1;c=a[d++];)b?o(c)?f.self(b,c.prototype,c):f.self(b,c):b=o(c)?f(a[0],c.prototype,c):f(a[0],c);return b||a[0]}function f(){var a=arguments,b=n(a[0]),c=b||o(a[0]),f=c?b?e(a[0]):a[0]:h,g=a[c?1:0]||{},i=a[c?2:1],k=g.__constructor||c&&f.prototype&&f.prototype.__constructor?function(){return this.__constructor.apply(this,arguments)}:c?function(){return f.apply(this,arguments)}:function(){};if(!c)return k.prototype=g,k.prototype.__self=k.prototype.constructor=k,l(k,i);l(k,f),k.__parent=f;var m=f.prototype,p=k.prototype=j(m);return p.__self=p.constructor=k,g&&d(m,p,g),i&&d(f,k,i),k}var g=function(){return"_"}.toString().indexOf("_")>-1,h=function(){},i=Object.prototype.hasOwnProperty,j=Object.create||function(a){var b=function(){};return b.prototype=a,new b},k=Object.keys||function(a){var b=[];for(var c in a)i.call(a,c)&&b.push(c);return b},l=function(a,b){for(var c in b)i.call(b,c)&&(a[c]=b[c]);return a},m=Object.prototype.toString,n=Array.isArray||function(a){return"[object Array]"===m.call(a)},o=function(a){return"[object Function]"===m.call(a)},p=function(){},q=!0,r={toString:""};for(var s in r)r.hasOwnProperty(s)&&(q=!1);var t=q?["toString","valueOf"]:null;f.self=function(){var a=arguments,b=n(a[0]),c=b?e(a[0],a[0][0]):a[0],f=a[1],g=a[2],h=c.prototype;return f&&d(h,h,f),g&&d(c,c,g),c};var u=!0;a.exports=f,u=!1,"object"==typeof modules&&"function"==typeof modules.define&&(modules.define("inherit",function(a){a(f)}),u=!1),u&&(b.inherit=f)}(e)}),Pa=Oa;if(!b.File)throw new Error("LeanCloud Storage SDK not installed");if(!c.TypedMessage)throw new Error("LeanCloud Realtime SDK not installed");var Qa=Pa(c.TypedMessage,{__constructor:function(a){if(!(a instanceof b.File))throw new TypeError("file must be an AV.File");if("string"!=typeof a.id)throw new Error("file must be saved before used to create a Message");this.__base(),this._file=a,this._lcfile={objId:a.id,url:a.url(),metaData:Na(a.metaData()||{},{name:a.name()})}},getFile:function(){return this._file}},{_parseFileFromRawData:function(a){if(!a||!a._lcfile)throw new Error("malformed FileMessage content");var c=a._lcfile.objId;"string"!=typeof c&&(c="");var d=b.File.createWithoutData(c);return d.attributes=d.attributes||{},d._url=d.attributes.url=a._lcfile.url,d._metaData=d.attributes.metaData=a._lcfile.metaData||{},a._lcfile.metaData&&(d._name=d.attributes.name=a._lcfile.metaData.name),d},parse:function(a,b){var c=this._parseFileFromRawData(a);return this.__base(a,b||new this(c))}});c.messageType(-6)(Qa),c.messageField("_lcfile")(Qa);var Ra=Pa(Qa);c.messageType(-2)(Ra);var Sa=Pa(Qa);c.messageType(-3)(Sa);var Ta=Pa(Qa);c.messageType(-4)(Ta);var Ua=Pa(c.TypedMessage,{__constructor:function(a){if(!(a instanceof b.GeoPoint))throw new TypeError("geoPoint must be an AV.GeoPoint");this.__base(),this._geoPoint=a;var c=a.latitude,d=a.longitude;this._lcloc={latitude:c,longitude:d}},getLocation:function(){return this._geoPoint}},{parse:function(a,c){var d=a._lcloc,e=d.latitude,f=d.longitude,g=new b.GeoPoint({latitude:e,longitude:f});return this.__base(a,c||new this(g))}});c.messageType(-5)(Ua),c.messageField("_lcloc")(Ua);var Va={name:"leancloud-realtime-plugin-typed-messages",messageClasses:[Qa,Ra,Sa,Ta,Ua]};a.TypedMessagesPlugin=Va,a.FileMessage=Qa,a.ImageMessage=Ra,a.AudioMessage=Sa,a.VideoMessage=Ta,a.LocationMessage=Ua,Object.defineProperty(a,"__esModule",{value:!0})});
//# sourceMappingURL=typed-messages.min.js.map