!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports,require("leancloud-storage"),require("leancloud-realtime")):"function"==typeof define&&define.amd?define("typed-messages",["exports","leancloud-storage","leancloud-realtime"],b):b(a.AV=a.AV||{},a.AV,a.AV)}(this,function(a,b,c){"use strict";function d(a,b){return b={exports:{}},a(b,b.exports),b.exports}var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},f=d(function(a){var b=a.exports={version:"2.4.0"};"number"==typeof __e&&(__e=b)}),g=f&&"object"==typeof f&&"default"in f?f["default"]:f,h=d(function(a){a.exports=function(a){try{return!!a()}catch(b){return!0}}}),i=h&&"object"==typeof h&&"default"in h?h["default"]:h,j=d(function(a){var b={}.toString;a.exports=function(a){return b.call(a).slice(8,-1)}}),k=j&&"object"==typeof j&&"default"in j?j["default"]:j,l=d(function(a){var b=k;a.exports=Object("z").propertyIsEnumerable(0)?Object:function(a){return"String"==b(a)?a.split(""):Object(a)}}),m=l&&"object"==typeof l&&"default"in l?l["default"]:l,n=d(function(a){a.exports=function(a){if(void 0==a)throw TypeError("Can't call method on  "+a);return a}}),o=n&&"object"==typeof n&&"default"in n?n["default"]:n,p=d(function(a){var b=o;a.exports=function(a){return Object(b(a))}}),q=p&&"object"==typeof p&&"default"in p?p["default"]:p,r=d(function(a,b){b.f={}.propertyIsEnumerable}),s=r&&"object"==typeof r&&"default"in r?r["default"]:r,t=d(function(a,b){b.f=Object.getOwnPropertySymbols}),u=t&&"object"==typeof t&&"default"in t?t["default"]:t,v=d(function(a){a.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")}),w=v&&"object"==typeof v&&"default"in v?v["default"]:v,x=d(function(a){var b=0,c=Math.random();a.exports=function(a){return"Symbol(".concat(void 0===a?"":a,")_",(++b+c).toString(36))}}),y=x&&"object"==typeof x&&"default"in x?x["default"]:x,z=d(function(a){var b=a.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=b)}),A=z&&"object"==typeof z&&"default"in z?z["default"]:z,B=d(function(a){var b=A,c="__core-js_shared__",d=b[c]||(b[c]={});a.exports=function(a){return d[a]||(d[a]={})}}),C=B&&"object"==typeof B&&"default"in B?B["default"]:B,D=d(function(a){var b=C("keys"),c=y;a.exports=function(a){return b[a]||(b[a]=c(a))}}),E=D&&"object"==typeof D&&"default"in D?D["default"]:D,F=d(function(a){var b=Math.ceil,c=Math.floor;a.exports=function(a){return isNaN(a=+a)?0:(a>0?c:b)(a)}}),G=F&&"object"==typeof F&&"default"in F?F["default"]:F,H=d(function(a){var b=G,c=Math.max,d=Math.min;a.exports=function(a,e){return a=b(a),a<0?c(a+e,0):d(a,e)}}),I=H&&"object"==typeof H&&"default"in H?H["default"]:H,J=d(function(a){var b=G,c=Math.min;a.exports=function(a){return a>0?c(b(a),9007199254740991):0}}),K=J&&"object"==typeof J&&"default"in J?J["default"]:J,L=d(function(a){var b=m,c=o;a.exports=function(a){return b(c(a))}}),M=L&&"object"==typeof L&&"default"in L?L["default"]:L,N=d(function(a){var b=M,c=K,d=I;a.exports=function(a){return function(e,f,g){var h,i=b(e),j=c(i.length),k=d(g,j);if(a&&f!=f){for(;j>k;)if(h=i[k++],h!=h)return!0}else for(;j>k;k++)if((a||k in i)&&i[k]===f)return a||k||0;return!a&&-1}}}),O=N&&"object"==typeof N&&"default"in N?N["default"]:N,P=d(function(a){var b={}.hasOwnProperty;a.exports=function(a,c){return b.call(a,c)}}),Q=P&&"object"==typeof P&&"default"in P?P["default"]:P,R=d(function(a){var b=Q,c=M,d=O(!1),e=E("IE_PROTO");a.exports=function(a,f){var g,h=c(a),i=0,j=[];for(g in h)g!=e&&b(h,g)&&j.push(g);for(;f.length>i;)b(h,g=f[i++])&&(~d(j,g)||j.push(g));return j}}),S=R&&"object"==typeof R&&"default"in R?R["default"]:R,T=d(function(a){var b=S,c=w;a.exports=Object.keys||function(a){return b(a,c)}}),U=T&&"object"==typeof T&&"default"in T?T["default"]:T,V=d(function(a){var b=U,c=u,d=s,e=q,f=m,g=Object.assign;a.exports=!g||i(function(){var a={},b={},c=Symbol(),d="abcdefghijklmnopqrst";return a[c]=7,d.split("").forEach(function(a){b[a]=a}),7!=g({},a)[c]||Object.keys(g({},b)).join("")!=d})?function(a,g){for(var h=e(a),i=arguments.length,j=1,k=c.f,l=d.f;i>j;)for(var m,n=f(arguments[j++]),o=k?b(n).concat(k(n)):b(n),p=o.length,q=0;p>q;)l.call(n,m=o[q++])&&(h[m]=n[m]);return h}:g}),W=V&&"object"==typeof V&&"default"in V?V["default"]:V,X=d(function(a){a.exports=!i(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})}),Y=X&&"object"==typeof X&&"default"in X?X["default"]:X,Z=d(function(a){a.exports=function(a,b){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:b}}}),$=Z&&"object"==typeof Z&&"default"in Z?Z["default"]:Z,_=d(function(a){a.exports=function(a){return"object"==typeof a?null!==a:"function"==typeof a}}),aa=_&&"object"==typeof _&&"default"in _?_["default"]:_,ba=d(function(a){var b=aa;a.exports=function(a,c){if(!b(a))return a;var d,e;if(c&&"function"==typeof(d=a.toString)&&!b(e=d.call(a)))return e;if("function"==typeof(d=a.valueOf)&&!b(e=d.call(a)))return e;if(!c&&"function"==typeof(d=a.toString)&&!b(e=d.call(a)))return e;throw TypeError("Can't convert object to primitive value")}}),ca=ba&&"object"==typeof ba&&"default"in ba?ba["default"]:ba,da=d(function(a){var b=aa,c=A.document,d=b(c)&&b(c.createElement);a.exports=function(a){return d?c.createElement(a):{}}}),ea=da&&"object"==typeof da&&"default"in da?da["default"]:da,fa=d(function(a){a.exports=!Y&&!i(function(){return 7!=Object.defineProperty(ea("div"),"a",{get:function(){return 7}}).a})}),ga=fa&&"object"==typeof fa&&"default"in fa?fa["default"]:fa,ha=d(function(a){var b=aa;a.exports=function(a){if(!b(a))throw TypeError(a+" is not an object!");return a}}),ia=ha&&"object"==typeof ha&&"default"in ha?ha["default"]:ha,ja=d(function(a,b){var c=ia,d=ga,e=ca,f=Object.defineProperty;b.f=Y?Object.defineProperty:function(a,b,g){if(c(a),b=e(b,!0),c(g),d)try{return f(a,b,g)}catch(h){}if("get"in g||"set"in g)throw TypeError("Accessors not supported!");return"value"in g&&(a[b]=g.value),a}}),ka=ja&&"object"==typeof ja&&"default"in ja?ja["default"]:ja,la=d(function(a){var b=ka,c=$;a.exports=Y?function(a,d,e){return b.f(a,d,c(1,e))}:function(a,b,c){return a[b]=c,a}}),ma=la&&"object"==typeof la&&"default"in la?la["default"]:la,na=d(function(a){a.exports=function(a){if("function"!=typeof a)throw TypeError(a+" is not a function!");return a}}),oa=na&&"object"==typeof na&&"default"in na?na["default"]:na,pa=d(function(a){var b=oa;a.exports=function(a,c,d){if(b(a),void 0===c)return a;switch(d){case 1:return function(b){return a.call(c,b)};case 2:return function(b,d){return a.call(c,b,d)};case 3:return function(b,d,e){return a.call(c,b,d,e)}}return function(){return a.apply(c,arguments)}}}),qa=pa&&"object"==typeof pa&&"default"in pa?pa["default"]:pa,ra=d(function(a,b){var c=A,d=g,e=qa,f=ma,h="prototype",i=function(a,b,g){var j,k,l,m=a&i.F,n=a&i.G,o=a&i.S,p=a&i.P,q=a&i.B,r=a&i.W,s=n?d:d[b]||(d[b]={}),t=s[h],u=n?c:o?c[b]:(c[b]||{})[h];n&&(g=b);for(j in g)k=!m&&u&&void 0!==u[j],k&&j in s||(l=k?u[j]:g[j],s[j]=n&&"function"!=typeof u[j]?g[j]:q&&k?e(l,c):r&&u[j]==l?function(a){var b=function(b,c,d){if(this instanceof a){switch(arguments.length){case 0:return new a;case 1:return new a(b);case 2:return new a(b,c)}return new a(b,c,d)}return a.apply(this,arguments)};return b[h]=a[h],b}(l):p&&"function"==typeof l?e(Function.call,l):l,p&&((s.virtual||(s.virtual={}))[j]=l,a&i.R&&t&&!t[j]&&f(t,j,l)))};i.F=1,i.G=2,i.S=4,i.P=8,i.B=16,i.W=32,i.U=64,i.R=128,a.exports=i}),sa=ra&&"object"==typeof ra&&"default"in ra?ra["default"]:ra,ta=(d(function(a){var b=sa;b(b.S+b.F,"Object",{assign:W})}),d(function(a){a.exports=g.Object.assign})),ua=ta&&"object"==typeof ta&&"default"in ta?ta["default"]:ta,va=d(function(a){a.exports={"default":ua,__esModule:!0}}),wa=va&&"object"==typeof va&&"default"in va?va["default"]:va;if(!b.File)throw new Error("LeanCloud Storage SDK not installed");if(!c.TypedMessage)throw new Error("LeanCloud Realtime SDK not installed");var xa=d(function(a,b){!function(c){function d(a){var b=l(a);if(r)for(var c,d=0;c=u[d++];)a.hasOwnProperty(c)&&b.push(c);return b}function e(a,b,c){for(var e,f,g=d(c),i=0,j=g.length;i<j;)"__self"!==(e=g[i++])&&(f=c[e],p(f)&&(!h||f.toString().indexOf(".__base")>-1)?b[e]=function(c,d){var e=a[c]?a[c]:"__constructor"===c?b.__self.__parent:q,f=function(){var a=this.__base;this.__base=f.__base;var b=d.apply(this,arguments);return this.__base=a,b};return f.__base=e,f}(e,f):b[e]=f)}function f(a,b){for(var c,d=1;c=a[d++];)b?p(c)?g.self(b,c.prototype,c):g.self(b,c):b=p(c)?g(a[0],c.prototype,c):g(a[0],c);return b||a[0]}function g(){var a=arguments,b=o(a[0]),c=b||p(a[0]),d=c?b?f(a[0]):a[0]:i,g=a[c?1:0]||{},h=a[c?2:1],j=g.__constructor||c&&d.prototype.__constructor?function(){return this.__constructor.apply(this,arguments)}:c?function(){return d.apply(this,arguments)}:function(){};if(!c)return j.prototype=g,j.prototype.__self=j.prototype.constructor=j,m(j,h);m(j,d),j.__parent=d;var l=d.prototype,n=j.prototype=k(l);return n.__self=n.constructor=j,g&&e(l,n,g),h&&e(d,j,h),j}var h=function(){"_"}.toString().indexOf("_")>-1,i=function(){},j=Object.prototype.hasOwnProperty,k=Object.create||function(a){var b=function(){};return b.prototype=a,new b},l=Object.keys||function(a){var b=[];for(var c in a)j.call(a,c)&&b.push(c);return b},m=function(a,b){for(var c in b)j.call(b,c)&&(a[c]=b[c]);return a},n=Object.prototype.toString,o=Array.isArray||function(a){return"[object Array]"===n.call(a)},p=function(a){return"[object Function]"===n.call(a)},q=function(){},r=!0,s={toString:""};for(var t in s)s.hasOwnProperty(t)&&(r=!1);var u=r?["toString","valueOf"]:null;g.self=function(){var a=arguments,b=o(a[0]),c=b?f(a[0],a[0][0]):a[0],d=a[1],g=a[2],h=c.prototype;return d&&e(h,h,d),g&&e(c,c,g),c};var v=!0;"object"==typeof b&&(a.exports=g,v=!1),"object"==typeof modules&&(modules.define("inherit",function(a){a(g)}),v=!1),"function"==typeof define&&(define(function(a,b,c){c.exports=g}),v=!1),v&&(c.inherit=g)}(e)}),ya=xa&&"object"==typeof xa&&"default"in xa?xa["default"]:xa,za=d(function(a){a.exports=ya}),Aa=za&&"object"==typeof za&&"default"in za?za["default"]:za,Ba=Aa(c.TypedMessage,{__constructor:function(a){if(!(a instanceof b.File))throw new TypeError("file must be an AV.File");if("string"!=typeof a.id)throw new Error("file must be saved before used to create a Message");this.__base(),this._file=a,this._lcfile={objId:a.id,url:a.url(),metaData:wa(a.metaData()||{},{name:a.name()})}},getFile:function(){return this._file}},{_parseFileFromRawData:function(a){if(!a||!a._lcfile)throw new Error("malformed FileMessage content");var c=a._lcfile.objId;"string"!=typeof c&&(c="");var d=b.File.createWithoutData(c);return d.attributes=d.attributes||{},d._url=d.attributes.url=a._lcfile.url,d._metaData=d.attributes.metaData=a._lcfile.metaData||{},a._lcfile.metaData&&(d._name=d.attributes.name=a._lcfile.metaData.name),d},parse:function(a,b){var c=this._parseFileFromRawData(a);return this.__base(a,b||new this(c))}});c.messageType(-6)(Ba),c.messageField("_lcfile")(Ba);var Ca=Aa(Ba);c.messageType(-2)(Ca);var Da=Aa(Ba);c.messageType(-3)(Da);var Ea=Aa(Ba);c.messageType(-4)(Ea);var Fa=Aa(c.TypedMessage,{__constructor:function(a){if(!(a instanceof b.GeoPoint))throw new TypeError("geoPoint must be an AV.GeoPoint");this.__base(),this._geoPoint=a;var c=a.latitude,d=a.longitude;this._lcloc={latitude:c,longitude:d}},getLocation:function(){return this._geoPoint}},{parse:function(a,c){var d=a._lcloc,e=d.latitude,f=d.longitude,g=new b.GeoPoint({latitude:e,longitude:f});return this.__base(a,c||new this(g))}});c.messageType(-5)(Fa),c.messageField("_lcloc")(Fa),a.FileMessage=Ba,a.ImageMessage=Ca,a.AudioMessage=Da,a.VideoMessage=Ea,a.LocationMessage=Fa,Object.defineProperty(a,"__esModule",{value:!0})});
//# sourceMappingURL=typed-messages.min.js.map